{"remainingRequest":"/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/thread-loader/dist/cjs.js!/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/babel-loader/lib/index.js!/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/vuetify/lib/components/VSelect/VSelect.js","dependencies":[{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/vuetify/lib/components/VSelect/VSelect.js","mtime":1670984980800},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/cache-loader/dist/cjs.js","mtime":1670984987973},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/thread-loader/dist/cjs.js","mtime":1670984981617},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/blog-vue/blog/blog-vue/node_modules/babel-loader/lib/index.js","mtime":1670984988372}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluZGV4LW9mIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICIvVXNlcnMvc3Vud2VuYm8vRG93bmxvYWRzL1x1NTM1QVx1NUJBMi9uZXctYmxvZy1tYXN0ZXIvYmxvZy12dWUvYmxvZy9ibG9nLXZ1ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL3N1bndlbmJvL0Rvd25sb2Fkcy9cdTUzNUFcdTVCQTIvbmV3LWJsb2ctbWFzdGVyL2Jsb2ctdnVlL2Jsb2cvYmxvZy12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3N1bndlbmJvL0Rvd25sb2Fkcy9cdTUzNUFcdTVCQTIvbmV3LWJsb2ctbWFzdGVyL2Jsb2ctdnVlL2Jsb2cvYmxvZy12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwovLyBTdHlsZXMKaW1wb3J0ICIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9WVGV4dEZpZWxkL1ZUZXh0RmllbGQuc2FzcyI7CmltcG9ydCAiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVlNlbGVjdC9WU2VsZWN0LnNhc3MiOyAvLyBDb21wb25lbnRzCgppbXBvcnQgVkNoaXAgZnJvbSAnLi4vVkNoaXAnOwppbXBvcnQgVk1lbnUgZnJvbSAnLi4vVk1lbnUnOwppbXBvcnQgVlNlbGVjdExpc3QgZnJvbSAnLi9WU2VsZWN0TGlzdCc7IC8vIEV4dGVuc2lvbnMKCmltcG9ydCBWSW5wdXQgZnJvbSAnLi4vVklucHV0JzsKaW1wb3J0IFZUZXh0RmllbGQgZnJvbSAnLi4vVlRleHRGaWVsZC9WVGV4dEZpZWxkJzsgLy8gTWl4aW5zCgppbXBvcnQgQ29tcGFyYWJsZSBmcm9tICcuLi8uLi9taXhpbnMvY29tcGFyYWJsZSc7CmltcG9ydCBEZXBlbmRlbnQgZnJvbSAnLi4vLi4vbWl4aW5zL2RlcGVuZGVudCc7CmltcG9ydCBGaWx0ZXJhYmxlIGZyb20gJy4uLy4uL21peGlucy9maWx0ZXJhYmxlJzsgLy8gRGlyZWN0aXZlcwoKaW1wb3J0IENsaWNrT3V0c2lkZSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2NsaWNrLW91dHNpZGUnOyAvLyBVdGlsaXRpZXMKCmltcG9ydCBtZXJnZURhdGEgZnJvbSAnLi4vLi4vdXRpbC9tZXJnZURhdGEnOwppbXBvcnQgeyBnZXRQcm9wZXJ0eUZyb21JdGVtLCBnZXRPYmplY3RWYWx1ZUJ5UGF0aCwga2V5Q29kZXMgfSBmcm9tICcuLi8uLi91dGlsL2hlbHBlcnMnOwppbXBvcnQgeyBjb25zb2xlRXJyb3IgfSBmcm9tICcuLi8uLi91dGlsL2NvbnNvbGUnOyAvLyBUeXBlcwoKaW1wb3J0IG1peGlucyBmcm9tICcuLi8uLi91dGlsL21peGlucyc7CmV4cG9ydCB2YXIgZGVmYXVsdE1lbnVQcm9wcyA9IHsKICBjbG9zZU9uQ2xpY2s6IGZhbHNlLAogIGNsb3NlT25Db250ZW50Q2xpY2s6IGZhbHNlLAogIGRpc2FibGVLZXlzOiB0cnVlLAogIG9wZW5PbkNsaWNrOiBmYWxzZSwKICBtYXhIZWlnaHQ6IDMwNAp9OyAvLyBUeXBlcwoKdmFyIGJhc2VNaXhpbnMgPSBtaXhpbnMoVlRleHRGaWVsZCwgQ29tcGFyYWJsZSwgRGVwZW5kZW50LCBGaWx0ZXJhYmxlKTsKLyogQHZ1ZS9jb21wb25lbnQgKi8KCmV4cG9ydCBkZWZhdWx0IGJhc2VNaXhpbnMuZXh0ZW5kKCkuZXh0ZW5kKHsKICBuYW1lOiAndi1zZWxlY3QnLAogIGRpcmVjdGl2ZXM6IHsKICAgIENsaWNrT3V0c2lkZTogQ2xpY2tPdXRzaWRlCiAgfSwKICBwcm9wczogewogICAgYXBwZW5kSWNvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICckZHJvcGRvd24nCiAgICB9LAogICAgYXR0YWNoOiB7CiAgICAgIHR5cGU6IG51bGwsCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgY2FjaGVJdGVtczogQm9vbGVhbiwKICAgIGNoaXBzOiBCb29sZWFuLAogICAgY2xlYXJhYmxlOiBCb29sZWFuLAogICAgZGVsZXRhYmxlQ2hpcHM6IEJvb2xlYW4sCiAgICBkaXNhYmxlTG9va3VwOiBCb29sZWFuLAogICAgZWFnZXI6IEJvb2xlYW4sCiAgICBoaWRlU2VsZWN0ZWQ6IEJvb2xlYW4sCiAgICBpdGVtczogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgaXRlbUNvbG9yOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3ByaW1hcnknCiAgICB9LAogICAgaXRlbURpc2FibGVkOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIEFycmF5LCBGdW5jdGlvbl0sCiAgICAgIGRlZmF1bHQ6ICdkaXNhYmxlZCcKICAgIH0sCiAgICBpdGVtVGV4dDogewogICAgICB0eXBlOiBbU3RyaW5nLCBBcnJheSwgRnVuY3Rpb25dLAogICAgICBkZWZhdWx0OiAndGV4dCcKICAgIH0sCiAgICBpdGVtVmFsdWU6IHsKICAgICAgdHlwZTogW1N0cmluZywgQXJyYXksIEZ1bmN0aW9uXSwKICAgICAgZGVmYXVsdDogJ3ZhbHVlJwogICAgfSwKICAgIG1lbnVQcm9wczogewogICAgICB0eXBlOiBbU3RyaW5nLCBBcnJheSwgT2JqZWN0XSwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRNZW51UHJvcHM7CiAgICAgIH0KICAgIH0sCiAgICBtdWx0aXBsZTogQm9vbGVhbiwKICAgIG9wZW5PbkNsZWFyOiBCb29sZWFuLAogICAgcmV0dXJuT2JqZWN0OiBCb29sZWFuLAogICAgc21hbGxDaGlwczogQm9vbGVhbgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNhY2hlZEl0ZW1zOiB0aGlzLmNhY2hlSXRlbXMgPyB0aGlzLml0ZW1zIDogW10sCiAgICAgIG1lbnVJc0Jvb3RlZDogZmFsc2UsCiAgICAgIGlzTWVudUFjdGl2ZTogZmFsc2UsCiAgICAgIGxhc3RJdGVtOiAyMCwKICAgICAgLy8gQXMgbG9uZyBhcyBhIHZhbHVlIGlzIGRlZmluZWQsIHNob3cgaXQKICAgICAgLy8gT3RoZXJ3aXNlLCBjaGVjayBpZiBtdWx0aXBsZQogICAgICAvLyB0byBkZXRlcm1pbmUgd2hpY2ggZGVmYXVsdCB0byBwcm92aWRlCiAgICAgIGxhenlWYWx1ZTogdGhpcy52YWx1ZSAhPT0gdW5kZWZpbmVkID8gdGhpcy52YWx1ZSA6IHRoaXMubXVsdGlwbGUgPyBbXSA6IHVuZGVmaW5lZCwKICAgICAgc2VsZWN0ZWRJbmRleDogLTEsCiAgICAgIHNlbGVjdGVkSXRlbXM6IFtdLAogICAgICBrZXlib2FyZExvb2t1cFByZWZpeDogJycsCiAgICAgIGtleWJvYXJkTG9va3VwTGFzdFRpbWU6IDAKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLyogQWxsIGl0ZW1zIHRoYXQgdGhlIHNlbGVjdCBoYXMgKi8KICAgIGFsbEl0ZW1zOiBmdW5jdGlvbiBhbGxJdGVtcygpIHsKICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyRHVwbGljYXRlcyh0aGlzLmNhY2hlZEl0ZW1zLmNvbmNhdCh0aGlzLml0ZW1zKSk7CiAgICB9LAogICAgY2xhc3NlczogZnVuY3Rpb24gY2xhc3NlcygpIHsKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoe30sIFZUZXh0RmllbGQub3B0aW9ucy5jb21wdXRlZC5jbGFzc2VzLmNhbGwodGhpcyksIHsKICAgICAgICAndi1zZWxlY3QnOiB0cnVlLAogICAgICAgICd2LXNlbGVjdC0tY2hpcHMnOiB0aGlzLmhhc0NoaXBzLAogICAgICAgICd2LXNlbGVjdC0tY2hpcHMtLXNtYWxsJzogdGhpcy5zbWFsbENoaXBzLAogICAgICAgICd2LXNlbGVjdC0taXMtbWVudS1hY3RpdmUnOiB0aGlzLmlzTWVudUFjdGl2ZSwKICAgICAgICAndi1zZWxlY3QtLWlzLW11bHRpJzogdGhpcy5tdWx0aXBsZQogICAgICB9KTsKICAgIH0sCgogICAgLyogVXNlZCBieSBvdGhlciBjb21wb25lbnRzIHRvIG92ZXJ3cml0ZSAqLwogICAgY29tcHV0ZWRJdGVtczogZnVuY3Rpb24gY29tcHV0ZWRJdGVtcygpIHsKICAgICAgcmV0dXJuIHRoaXMuYWxsSXRlbXM7CiAgICB9LAogICAgY29tcHV0ZWRPd25zOiBmdW5jdGlvbiBjb21wdXRlZE93bnMoKSB7CiAgICAgIHJldHVybiAibGlzdC0iLmNvbmNhdCh0aGlzLl91aWQpOwogICAgfSwKICAgIGNvbXB1dGVkQ291bnRlclZhbHVlOiBmdW5jdGlvbiBjb21wdXRlZENvdW50ZXJWYWx1ZSgpIHsKICAgICAgdmFyIHZhbHVlID0gdGhpcy5tdWx0aXBsZSA/IHRoaXMuc2VsZWN0ZWRJdGVtcyA6ICh0aGlzLmdldFRleHQodGhpcy5zZWxlY3RlZEl0ZW1zWzBdKSB8fCAnJykudG9TdHJpbmcoKTsKCiAgICAgIGlmICh0eXBlb2YgdGhpcy5jb3VudGVyVmFsdWUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICByZXR1cm4gdGhpcy5jb3VudGVyVmFsdWUodmFsdWUpOwogICAgICB9CgogICAgICByZXR1cm4gdmFsdWUubGVuZ3RoOwogICAgfSwKICAgIGRpcmVjdGl2ZXM6IGZ1bmN0aW9uIGRpcmVjdGl2ZXMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy5pc0ZvY3VzZWQgPyBbewogICAgICAgIG5hbWU6ICdjbGljay1vdXRzaWRlJywKICAgICAgICB2YWx1ZTogewogICAgICAgICAgaGFuZGxlcjogdGhpcy5ibHVyLAogICAgICAgICAgY2xvc2VDb25kaXRpb25hbDogdGhpcy5jbG9zZUNvbmRpdGlvbmFsLAogICAgICAgICAgaW5jbHVkZTogZnVuY3Rpb24gaW5jbHVkZSgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzLmdldE9wZW5EZXBlbmRlbnRFbGVtZW50cygpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfV0gOiB1bmRlZmluZWQ7CiAgICB9LAogICAgZHluYW1pY0hlaWdodDogZnVuY3Rpb24gZHluYW1pY0hlaWdodCgpIHsKICAgICAgcmV0dXJuICdhdXRvJzsKICAgIH0sCiAgICBoYXNDaGlwczogZnVuY3Rpb24gaGFzQ2hpcHMoKSB7CiAgICAgIHJldHVybiB0aGlzLmNoaXBzIHx8IHRoaXMuc21hbGxDaGlwczsKICAgIH0sCiAgICBoYXNTbG90OiBmdW5jdGlvbiBoYXNTbG90KCkgewogICAgICByZXR1cm4gQm9vbGVhbih0aGlzLmhhc0NoaXBzIHx8IHRoaXMuJHNjb3BlZFNsb3RzLnNlbGVjdGlvbik7CiAgICB9LAogICAgaXNEaXJ0eTogZnVuY3Rpb24gaXNEaXJ0eSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRJdGVtcy5sZW5ndGggPiAwOwogICAgfSwKICAgIGxpc3REYXRhOiBmdW5jdGlvbiBsaXN0RGF0YSgpIHsKICAgICAgdmFyIHNjb3BlSWQgPSB0aGlzLiR2bm9kZSAmJiB0aGlzLiR2bm9kZS5jb250ZXh0LiRvcHRpb25zLl9zY29wZUlkOwogICAgICB2YXIgYXR0cnMgPSBzY29wZUlkID8gX2RlZmluZVByb3BlcnR5KHt9LCBzY29wZUlkLCB0cnVlKSA6IHt9OwogICAgICByZXR1cm4gewogICAgICAgIGF0dHJzOiBfb2JqZWN0U3ByZWFkKHt9LCBhdHRycywgewogICAgICAgICAgaWQ6IHRoaXMuY29tcHV0ZWRPd25zCiAgICAgICAgfSksCiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIGFjdGlvbjogdGhpcy5tdWx0aXBsZSwKICAgICAgICAgIGNvbG9yOiB0aGlzLml0ZW1Db2xvciwKICAgICAgICAgIGRlbnNlOiB0aGlzLmRlbnNlLAogICAgICAgICAgaGlkZVNlbGVjdGVkOiB0aGlzLmhpZGVTZWxlY3RlZCwKICAgICAgICAgIGl0ZW1zOiB0aGlzLnZpcnR1YWxpemVkSXRlbXMsCiAgICAgICAgICBpdGVtRGlzYWJsZWQ6IHRoaXMuaXRlbURpc2FibGVkLAogICAgICAgICAgaXRlbVRleHQ6IHRoaXMuaXRlbVRleHQsCiAgICAgICAgICBpdGVtVmFsdWU6IHRoaXMuaXRlbVZhbHVlLAogICAgICAgICAgbm9EYXRhVGV4dDogdGhpcy4kdnVldGlmeS5sYW5nLnQodGhpcy5ub0RhdGFUZXh0KSwKICAgICAgICAgIHNlbGVjdGVkSXRlbXM6IHRoaXMuc2VsZWN0ZWRJdGVtcwogICAgICAgIH0sCiAgICAgICAgb246IHsKICAgICAgICAgIHNlbGVjdDogdGhpcy5zZWxlY3RJdGVtCiAgICAgICAgfSwKICAgICAgICBzY29wZWRTbG90czogewogICAgICAgICAgaXRlbTogdGhpcy4kc2NvcGVkU2xvdHMuaXRlbQogICAgICAgIH0KICAgICAgfTsKICAgIH0sCiAgICBzdGF0aWNMaXN0OiBmdW5jdGlvbiBzdGF0aWNMaXN0KCkgewogICAgICBpZiAodGhpcy4kc2xvdHNbJ25vLWRhdGEnXSB8fCB0aGlzLiRzbG90c1sncHJlcGVuZC1pdGVtJ10gfHwgdGhpcy4kc2xvdHNbJ2FwcGVuZC1pdGVtJ10pIHsKICAgICAgICBjb25zb2xlRXJyb3IoJ2Fzc2VydDogc3RhdGljTGlzdCBzaG91bGQgbm90IGJlIGNhbGxlZCBpZiBzbG90cyBhcmUgdXNlZCcpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWU2VsZWN0TGlzdCwgdGhpcy5saXN0RGF0YSk7CiAgICB9LAogICAgdmlydHVhbGl6ZWRJdGVtczogZnVuY3Rpb24gdmlydHVhbGl6ZWRJdGVtcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJF9tZW51UHJvcHMuYXV0byA/IHRoaXMuY29tcHV0ZWRJdGVtcyA6IHRoaXMuY29tcHV0ZWRJdGVtcy5zbGljZSgwLCB0aGlzLmxhc3RJdGVtKTsKICAgIH0sCiAgICBtZW51Q2FuU2hvdzogZnVuY3Rpb24gbWVudUNhblNob3coKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKICAgICRfbWVudVByb3BzOiBmdW5jdGlvbiAkX21lbnVQcm9wcygpIHsKICAgICAgdmFyIG5vcm1hbGlzZWRQcm9wcyA9IHR5cGVvZiB0aGlzLm1lbnVQcm9wcyA9PT0gJ3N0cmluZycgPyB0aGlzLm1lbnVQcm9wcy5zcGxpdCgnLCcpIDogdGhpcy5tZW51UHJvcHM7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShub3JtYWxpc2VkUHJvcHMpKSB7CiAgICAgICAgbm9ybWFsaXNlZFByb3BzID0gbm9ybWFsaXNlZFByb3BzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwKSB7CiAgICAgICAgICBhY2NbcC50cmltKCldID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiBhY2M7CiAgICAgICAgfSwge30pOwogICAgICB9CgogICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7fSwgZGVmYXVsdE1lbnVQcm9wcywgewogICAgICAgIGVhZ2VyOiB0aGlzLmVhZ2VyLAogICAgICAgIHZhbHVlOiB0aGlzLm1lbnVDYW5TaG93ICYmIHRoaXMuaXNNZW51QWN0aXZlLAogICAgICAgIG51ZGdlQm90dG9tOiBub3JtYWxpc2VkUHJvcHMub2Zmc2V0WSA/IDEgOiAwCiAgICAgIH0sIG5vcm1hbGlzZWRQcm9wcyk7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgaW50ZXJuYWxWYWx1ZTogZnVuY3Rpb24gaW50ZXJuYWxWYWx1ZSh2YWwpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmluaXRpYWxWYWx1ZSA9IHZhbDsKICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW1zKCk7CgogICAgICBpZiAodGhpcy5tdWx0aXBsZSkgewogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBfdGhpcyQkcmVmcyRtZW51OwoKICAgICAgICAgIChfdGhpcyQkcmVmcyRtZW51ID0gX3RoaXMyLiRyZWZzLm1lbnUpID09IG51bGwgPyB2b2lkIDAgOiBfdGhpcyQkcmVmcyRtZW51LnVwZGF0ZURpbWVuc2lvbnMoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGlzTWVudUFjdGl2ZTogZnVuY3Rpb24gaXNNZW51QWN0aXZlKHZhbCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLm9uTWVudUFjdGl2ZUNoYW5nZSh2YWwpOwogICAgICB9KTsKICAgIH0sCiAgICBpdGVtczogewogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIodmFsKSB7CiAgICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICAgIGlmICh0aGlzLmNhY2hlSXRlbXMpIHsKICAgICAgICAgIC8vIEJyZWFrcyB2dWUtdGVzdC11dGlscyBpZgogICAgICAgICAgLy8gdGhpcyBpc24ndCBjYWxjdWxhdGVkCiAgICAgICAgICAvLyBvbiB0aGUgbmV4dCB0aWNrCiAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzNC5jYWNoZWRJdGVtcyA9IF90aGlzNC5maWx0ZXJEdXBsaWNhdGVzKF90aGlzNC5jYWNoZWRJdGVtcy5jb25jYXQodmFsKSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtcygpOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvKiogQHB1YmxpYyAqLwogICAgYmx1cjogZnVuY3Rpb24gYmx1cihlKSB7CiAgICAgIFZUZXh0RmllbGQub3B0aW9ucy5tZXRob2RzLmJsdXIuY2FsbCh0aGlzLCBlKTsKICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTsKICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7CiAgICAgIHRoaXMuc2V0TWVudUluZGV4KC0xKTsKICAgIH0sCgogICAgLyoqIEBwdWJsaWMgKi8KICAgIGFjdGl2YXRlTWVudTogZnVuY3Rpb24gYWN0aXZhdGVNZW51KCkgewogICAgICBpZiAoIXRoaXMuaXNJbnRlcmFjdGl2ZSB8fCB0aGlzLmlzTWVudUFjdGl2ZSkgcmV0dXJuOwogICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IHRydWU7CiAgICB9LAogICAgY2xlYXJhYmxlQ2FsbGJhY2s6IGZ1bmN0aW9uIGNsZWFyYWJsZUNhbGxiYWNrKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5tdWx0aXBsZSA/IFtdIDogbnVsbCk7CiAgICAgIHRoaXMuc2V0TWVudUluZGV4KC0xKTsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczUuJHJlZnMuaW5wdXQgJiYgX3RoaXM1LiRyZWZzLmlucHV0LmZvY3VzKCk7CiAgICAgIH0pOwogICAgICBpZiAodGhpcy5vcGVuT25DbGVhcikgdGhpcy5pc01lbnVBY3RpdmUgPSB0cnVlOwogICAgfSwKICAgIGNsb3NlQ29uZGl0aW9uYWw6IGZ1bmN0aW9uIGNsb3NlQ29uZGl0aW9uYWwoZSkgewogICAgICBpZiAoIXRoaXMuaXNNZW51QWN0aXZlKSByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuICF0aGlzLl9pc0Rlc3Ryb3llZCAmJiAoIC8vIENsaWNrIG9yaWdpbmF0ZXMgZnJvbSBvdXRzaWRlIHRoZSBtZW51IGNvbnRlbnQKICAgICAgLy8gTXVsdGlwbGUgc2VsZWN0cyBkb24ndCBjbG9zZSB3aGVuIGFuIGl0ZW0gaXMgY2xpY2tlZAogICAgICAhdGhpcy5nZXRDb250ZW50KCkgfHwgIXRoaXMuZ2V0Q29udGVudCgpLmNvbnRhaW5zKGUudGFyZ2V0KSkgJiYgLy8gQ2xpY2sgb3JpZ2luYXRlcyBmcm9tIG91dHNpZGUgdGhlIGVsZW1lbnQKICAgICAgdGhpcy4kZWwgJiYgIXRoaXMuJGVsLmNvbnRhaW5zKGUudGFyZ2V0KSAmJiBlLnRhcmdldCAhPT0gdGhpcy4kZWw7CiAgICB9LAogICAgZmlsdGVyRHVwbGljYXRlczogZnVuY3Rpb24gZmlsdGVyRHVwbGljYXRlcyhhcnIpIHsKICAgICAgdmFyIHVuaXF1ZVZhbHVlcyA9IG5ldyBNYXAoKTsKCiAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBhcnIubGVuZ3RoOyArK2luZGV4KSB7CiAgICAgICAgdmFyIGl0ZW0gPSBhcnJbaW5kZXhdOyAvLyBEbyBub3QgcmV0dXJuIG51bGwgdmFsdWVzIGlmIGV4aXN0YW50ICgjMTQ0MjEpCgogICAgICAgIGlmIChpdGVtID09IG51bGwpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gRG8gbm90IGRlZHVwbGljYXRlIGhlYWRlcnMgb3IgZGl2aWRlcnMgKCMxMjUxNykKCgogICAgICAgIGlmIChpdGVtLmhlYWRlciB8fCBpdGVtLmRpdmlkZXIpIHsKICAgICAgICAgIHVuaXF1ZVZhbHVlcy5zZXQoaXRlbSwgaXRlbSk7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIHZhciB2YWwgPSB0aGlzLmdldFZhbHVlKGl0ZW0pOyAvLyBUT0RPOiBjb21wYXJhdG9yCgogICAgICAgICF1bmlxdWVWYWx1ZXMuaGFzKHZhbCkgJiYgdW5pcXVlVmFsdWVzLnNldCh2YWwsIGl0ZW0pOwogICAgICB9CgogICAgICByZXR1cm4gQXJyYXkuZnJvbSh1bmlxdWVWYWx1ZXMudmFsdWVzKCkpOwogICAgfSwKICAgIGZpbmRFeGlzdGluZ0luZGV4OiBmdW5jdGlvbiBmaW5kRXhpc3RpbmdJbmRleChpdGVtKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdmFyIGl0ZW1WYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoaXRlbSk7CiAgICAgIHJldHVybiAodGhpcy5pbnRlcm5hbFZhbHVlIHx8IFtdKS5maW5kSW5kZXgoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gX3RoaXM2LnZhbHVlQ29tcGFyYXRvcihfdGhpczYuZ2V0VmFsdWUoaSksIGl0ZW1WYWx1ZSk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldENvbnRlbnQ6IGZ1bmN0aW9uIGdldENvbnRlbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyZWZzLm1lbnUgJiYgdGhpcy4kcmVmcy5tZW51LiRyZWZzLmNvbnRlbnQ7CiAgICB9LAogICAgZ2VuQ2hpcFNlbGVjdGlvbjogZnVuY3Rpb24gZ2VuQ2hpcFNlbGVjdGlvbihpdGVtLCBpbmRleCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHZhciBpc0Rpc2FibGVkID0gdGhpcy5pc0Rpc2FibGVkIHx8IHRoaXMuZ2V0RGlzYWJsZWQoaXRlbSk7CiAgICAgIHZhciBpc0ludGVyYWN0aXZlID0gIWlzRGlzYWJsZWQgJiYgdGhpcy5pc0ludGVyYWN0aXZlOwogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWQ2hpcCwgewogICAgICAgIHN0YXRpY0NsYXNzOiAndi1jaGlwLS1zZWxlY3QnLAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICB0YWJpbmRleDogLTEKICAgICAgICB9LAogICAgICAgIHByb3BzOiB7CiAgICAgICAgICBjbG9zZTogdGhpcy5kZWxldGFibGVDaGlwcyAmJiBpc0ludGVyYWN0aXZlLAogICAgICAgICAgZGlzYWJsZWQ6IGlzRGlzYWJsZWQsCiAgICAgICAgICBpbnB1dFZhbHVlOiBpbmRleCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4LAogICAgICAgICAgc21hbGw6IHRoaXMuc21hbGxDaGlwcwogICAgICAgIH0sCiAgICAgICAgb246IHsKICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiBjbGljayhlKSB7CiAgICAgICAgICAgIGlmICghaXNJbnRlcmFjdGl2ZSkgcmV0dXJuOwogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICBfdGhpczcuc2VsZWN0ZWRJbmRleCA9IGluZGV4OwogICAgICAgICAgfSwKICAgICAgICAgICdjbGljazpjbG9zZSc6IGZ1bmN0aW9uIGNsaWNrQ2xvc2UoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczcub25DaGlwSW5wdXQoaXRlbSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBrZXk6IEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0VmFsdWUoaXRlbSkpCiAgICAgIH0sIHRoaXMuZ2V0VGV4dChpdGVtKSk7CiAgICB9LAogICAgZ2VuQ29tbWFTZWxlY3Rpb246IGZ1bmN0aW9uIGdlbkNvbW1hU2VsZWN0aW9uKGl0ZW0sIGluZGV4LCBsYXN0KSB7CiAgICAgIHZhciBjb2xvciA9IGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXggJiYgdGhpcy5jb21wdXRlZENvbG9yOwogICAgICB2YXIgaXNEaXNhYmxlZCA9IHRoaXMuaXNEaXNhYmxlZCB8fCB0aGlzLmdldERpc2FibGVkKGl0ZW0pOwogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2JywgdGhpcy5zZXRUZXh0Q29sb3IoY29sb3IsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ3Ytc2VsZWN0X19zZWxlY3Rpb24gdi1zZWxlY3RfX3NlbGVjdGlvbi0tY29tbWEnLAogICAgICAgIGNsYXNzOiB7CiAgICAgICAgICAndi1zZWxlY3RfX3NlbGVjdGlvbi0tZGlzYWJsZWQnOiBpc0Rpc2FibGVkCiAgICAgICAgfSwKICAgICAgICBrZXk6IEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0VmFsdWUoaXRlbSkpCiAgICAgIH0pLCAiIi5jb25jYXQodGhpcy5nZXRUZXh0KGl0ZW0pKS5jb25jYXQobGFzdCA/ICcnIDogJywgJykpOwogICAgfSwKICAgIGdlbkRlZmF1bHRTbG90OiBmdW5jdGlvbiBnZW5EZWZhdWx0U2xvdCgpIHsKICAgICAgdmFyIHNlbGVjdGlvbnMgPSB0aGlzLmdlblNlbGVjdGlvbnMoKTsKICAgICAgdmFyIGlucHV0ID0gdGhpcy5nZW5JbnB1dCgpOyAvLyBJZiB0aGUgcmV0dXJuIGlzIGFuIGVtcHR5IGFycmF5CiAgICAgIC8vIHB1c2ggdGhlIGlucHV0CgogICAgICBpZiAoQXJyYXkuaXNBcnJheShzZWxlY3Rpb25zKSkgewogICAgICAgIHNlbGVjdGlvbnMucHVzaChpbnB1dCk7IC8vIE90aGVyd2lzZSBwdXNoIGl0IGludG8gY2hpbGRyZW4KICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxlY3Rpb25zLmNoaWxkcmVuID0gc2VsZWN0aW9ucy5jaGlsZHJlbiB8fCBbXTsKICAgICAgICBzZWxlY3Rpb25zLmNoaWxkcmVuLnB1c2goaW5wdXQpOwogICAgICB9CgogICAgICByZXR1cm4gW3RoaXMuZ2VuRmllbGRzZXQoKSwgdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2JywgewogICAgICAgIHN0YXRpY0NsYXNzOiAndi1zZWxlY3RfX3Nsb3QnLAogICAgICAgIGRpcmVjdGl2ZXM6IHRoaXMuZGlyZWN0aXZlcwogICAgICB9LCBbdGhpcy5nZW5MYWJlbCgpLCB0aGlzLnByZWZpeCA/IHRoaXMuZ2VuQWZmaXgoJ3ByZWZpeCcpIDogbnVsbCwgc2VsZWN0aW9ucywgdGhpcy5zdWZmaXggPyB0aGlzLmdlbkFmZml4KCdzdWZmaXgnKSA6IG51bGwsIHRoaXMuZ2VuQ2xlYXJJY29uKCksIHRoaXMuZ2VuSWNvblNsb3QoKSwgdGhpcy5nZW5IaWRkZW5JbnB1dCgpXSksIHRoaXMuZ2VuTWVudSgpLCB0aGlzLmdlblByb2dyZXNzKCldOwogICAgfSwKICAgIGdlbkljb246IGZ1bmN0aW9uIGdlbkljb24odHlwZSwgY2IsIGV4dHJhRGF0YSkgewogICAgICB2YXIgaWNvbiA9IFZJbnB1dC5vcHRpb25zLm1ldGhvZHMuZ2VuSWNvbi5jYWxsKHRoaXMsIHR5cGUsIGNiLCBleHRyYURhdGEpOwoKICAgICAgaWYgKHR5cGUgPT09ICdhcHBlbmQnKSB7CiAgICAgICAgLy8gRG9uJ3QgYWxsb3cgdGhlIGRyb3Bkb3duIGljb24gdG8gYmUgZm9jdXNlZAogICAgICAgIGljb24uY2hpbGRyZW5bMF0uZGF0YSA9IG1lcmdlRGF0YShpY29uLmNoaWxkcmVuWzBdLmRhdGEsIHsKICAgICAgICAgIGF0dHJzOiB7CiAgICAgICAgICAgIHRhYmluZGV4OiBpY29uLmNoaWxkcmVuWzBdLmNvbXBvbmVudE9wdGlvbnMubGlzdGVuZXJzICYmICctMScsCiAgICAgICAgICAgICdhcmlhLWhpZGRlbic6ICd0cnVlJywKICAgICAgICAgICAgJ2FyaWEtbGFiZWwnOiB1bmRlZmluZWQKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGljb247CiAgICB9LAogICAgZ2VuSW5wdXQ6IGZ1bmN0aW9uIGdlbklucHV0KCkgewogICAgICB2YXIgaW5wdXQgPSBWVGV4dEZpZWxkLm9wdGlvbnMubWV0aG9kcy5nZW5JbnB1dC5jYWxsKHRoaXMpOwogICAgICBkZWxldGUgaW5wdXQuZGF0YS5hdHRycy5uYW1lOwogICAgICBpbnB1dC5kYXRhID0gbWVyZ2VEYXRhKGlucHV0LmRhdGEsIHsKICAgICAgICBkb21Qcm9wczogewogICAgICAgICAgdmFsdWU6IG51bGwKICAgICAgICB9LAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICByZWFkb25seTogdHJ1ZSwKICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICdhcmlhLXJlYWRvbmx5JzogU3RyaW5nKHRoaXMuaXNSZWFkb25seSksCiAgICAgICAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogZ2V0T2JqZWN0VmFsdWVCeVBhdGgodGhpcy4kcmVmcy5tZW51LCAnYWN0aXZlVGlsZS5pZCcpLAogICAgICAgICAgYXV0b2NvbXBsZXRlOiBnZXRPYmplY3RWYWx1ZUJ5UGF0aChpbnB1dC5kYXRhLCAnYXR0cnMuYXV0b2NvbXBsZXRlJywgJ29mZicpLAogICAgICAgICAgcGxhY2Vob2xkZXI6ICF0aGlzLmlzRGlydHkgJiYgKHRoaXMucGVyc2lzdGVudFBsYWNlaG9sZGVyIHx8IHRoaXMuaXNGb2N1c2VkIHx8ICF0aGlzLmhhc0xhYmVsKSA/IHRoaXMucGxhY2Vob2xkZXIgOiB1bmRlZmluZWQKICAgICAgICB9LAogICAgICAgIG9uOiB7CiAgICAgICAgICBrZXlwcmVzczogdGhpcy5vbktleVByZXNzCiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGlucHV0OwogICAgfSwKICAgIGdlbkhpZGRlbklucHV0OiBmdW5jdGlvbiBnZW5IaWRkZW5JbnB1dCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ2lucHV0JywgewogICAgICAgIGRvbVByb3BzOiB7CiAgICAgICAgICB2YWx1ZTogdGhpcy5sYXp5VmFsdWUKICAgICAgICB9LAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICB0eXBlOiAnaGlkZGVuJywKICAgICAgICAgIG5hbWU6IHRoaXMuYXR0cnMkLm5hbWUKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdlbklucHV0U2xvdDogZnVuY3Rpb24gZ2VuSW5wdXRTbG90KCkgewogICAgICB2YXIgcmVuZGVyID0gVlRleHRGaWVsZC5vcHRpb25zLm1ldGhvZHMuZ2VuSW5wdXRTbG90LmNhbGwodGhpcyk7CiAgICAgIHJlbmRlci5kYXRhLmF0dHJzID0gX29iamVjdFNwcmVhZCh7fSwgcmVuZGVyLmRhdGEuYXR0cnMsIHsKICAgICAgICByb2xlOiAnYnV0dG9uJywKICAgICAgICAnYXJpYS1oYXNwb3B1cCc6ICdsaXN0Ym94JywKICAgICAgICAnYXJpYS1leHBhbmRlZCc6IFN0cmluZyh0aGlzLmlzTWVudUFjdGl2ZSksCiAgICAgICAgJ2FyaWEtb3ducyc6IHRoaXMuY29tcHV0ZWRPd25zCiAgICAgIH0pOwogICAgICByZXR1cm4gcmVuZGVyOwogICAgfSwKICAgIGdlbkxpc3Q6IGZ1bmN0aW9uIGdlbkxpc3QoKSB7CiAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gc2xvdHMsIHdlIGNhbiB1c2UgYSBjYWNoZWQgVk5vZGUgdG8gaW1wcm92ZSBwZXJmb3JtYW5jZQogICAgICBpZiAodGhpcy4kc2xvdHNbJ25vLWRhdGEnXSB8fCB0aGlzLiRzbG90c1sncHJlcGVuZC1pdGVtJ10gfHwgdGhpcy4kc2xvdHNbJ2FwcGVuZC1pdGVtJ10pIHsKICAgICAgICByZXR1cm4gdGhpcy5nZW5MaXN0V2l0aFNsb3QoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5zdGF0aWNMaXN0OwogICAgICB9CiAgICB9LAogICAgZ2VuTGlzdFdpdGhTbG90OiBmdW5jdGlvbiBnZW5MaXN0V2l0aFNsb3QoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHNsb3RzID0gWydwcmVwZW5kLWl0ZW0nLCAnbm8tZGF0YScsICdhcHBlbmQtaXRlbSddLmZpbHRlcihmdW5jdGlvbiAoc2xvdE5hbWUpIHsKICAgICAgICByZXR1cm4gX3RoaXM4LiRzbG90c1tzbG90TmFtZV07CiAgICAgIH0pLm1hcChmdW5jdGlvbiAoc2xvdE5hbWUpIHsKICAgICAgICByZXR1cm4gX3RoaXM4LiRjcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScsIHsKICAgICAgICAgIHNsb3Q6IHNsb3ROYW1lCiAgICAgICAgfSwgX3RoaXM4LiRzbG90c1tzbG90TmFtZV0pOwogICAgICB9KTsgLy8gUmVxdWlyZXMgZGVzdHJ1Y3R1cmluZyBkdWUgdG8gVnVlCiAgICAgIC8vIG1vZGlmeWluZyB0aGUgYG9uYCBwcm9wZXJ0eSB3aGVuIHBhc3NlZAogICAgICAvLyBhcyBhIHJlZmVyZW5jZWQgb2JqZWN0CgogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWU2VsZWN0TGlzdCwgX29iamVjdFNwcmVhZCh7fSwgdGhpcy5saXN0RGF0YSksIHNsb3RzKTsKICAgIH0sCiAgICBnZW5NZW51OiBmdW5jdGlvbiBnZW5NZW51KCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHZhciBwcm9wcyA9IHRoaXMuJF9tZW51UHJvcHM7CiAgICAgIHByb3BzLmFjdGl2YXRvciA9IHRoaXMuJHJlZnNbJ2lucHV0LXNsb3QnXTsgLy8gQXR0YWNoIHRvIHJvb3QgZWwgc28gdGhhdAogICAgICAvLyBtZW51IGNvdmVycyBwcmVwZW5kL2FwcGVuZCBpY29ucwoKICAgICAgaWYgKCAvLyBUT0RPOiBtYWtlIHRoaXMgYSBjb21wdXRlZCBwcm9wZXJ0eSBvciBoZWxwZXIgb3Igc29tZXRoaW5nCiAgICAgIHRoaXMuYXR0YWNoID09PSAnJyB8fCAvLyBJZiB1c2VkIGFzIGEgYm9vbGVhbiBwcm9wICg8di1tZW51IGF0dGFjaD4pCiAgICAgIHRoaXMuYXR0YWNoID09PSB0cnVlIHx8IC8vIElmIGJvdW5kIHRvIGEgYm9vbGVhbiAoPHYtbWVudSA6YXR0YWNoPSJ0cnVlIj4pCiAgICAgIHRoaXMuYXR0YWNoID09PSAnYXR0YWNoJyAvLyBJZiBib3VuZCBhcyBib29sZWFuIHByb3AgaW4gcHVnICh2LW1lbnUoYXR0YWNoKSkKICAgICAgKSB7CiAgICAgICAgICBwcm9wcy5hdHRhY2ggPSB0aGlzLiRlbDsKICAgICAgICB9IGVsc2UgewogICAgICAgIHByb3BzLmF0dGFjaCA9IHRoaXMuYXR0YWNoOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudChWTWVudSwgewogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICByb2xlOiB1bmRlZmluZWQKICAgICAgICB9LAogICAgICAgIHByb3BzOiBwcm9wcywKICAgICAgICBvbjogewogICAgICAgICAgaW5wdXQ6IGZ1bmN0aW9uIGlucHV0KHZhbCkgewogICAgICAgICAgICBfdGhpczkuaXNNZW51QWN0aXZlID0gdmFsOwogICAgICAgICAgICBfdGhpczkuaXNGb2N1c2VkID0gdmFsOwogICAgICAgICAgfSwKICAgICAgICAgIHNjcm9sbDogdGhpcy5vblNjcm9sbAogICAgICAgIH0sCiAgICAgICAgcmVmOiAnbWVudScKICAgICAgfSwgW3RoaXMuZ2VuTGlzdCgpXSk7CiAgICB9LAogICAgZ2VuU2VsZWN0aW9uczogZnVuY3Rpb24gZ2VuU2VsZWN0aW9ucygpIHsKICAgICAgdmFyIGxlbmd0aCA9IHRoaXMuc2VsZWN0ZWRJdGVtcy5sZW5ndGg7CiAgICAgIHZhciBjaGlsZHJlbiA9IG5ldyBBcnJheShsZW5ndGgpOwogICAgICB2YXIgZ2VuU2VsZWN0aW9uOwoKICAgICAgaWYgKHRoaXMuJHNjb3BlZFNsb3RzLnNlbGVjdGlvbikgewogICAgICAgIGdlblNlbGVjdGlvbiA9IHRoaXMuZ2VuU2xvdFNlbGVjdGlvbjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc0NoaXBzKSB7CiAgICAgICAgZ2VuU2VsZWN0aW9uID0gdGhpcy5nZW5DaGlwU2VsZWN0aW9uOwogICAgICB9IGVsc2UgewogICAgICAgIGdlblNlbGVjdGlvbiA9IHRoaXMuZ2VuQ29tbWFTZWxlY3Rpb247CiAgICAgIH0KCiAgICAgIHdoaWxlIChsZW5ndGgtLSkgewogICAgICAgIGNoaWxkcmVuW2xlbmd0aF0gPSBnZW5TZWxlY3Rpb24odGhpcy5zZWxlY3RlZEl0ZW1zW2xlbmd0aF0sIGxlbmd0aCwgbGVuZ3RoID09PSBjaGlsZHJlbi5sZW5ndGggLSAxKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ3Ytc2VsZWN0X19zZWxlY3Rpb25zJwogICAgICB9LCBjaGlsZHJlbik7CiAgICB9LAogICAgZ2VuU2xvdFNlbGVjdGlvbjogZnVuY3Rpb24gZ2VuU2xvdFNlbGVjdGlvbihpdGVtLCBpbmRleCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICByZXR1cm4gdGhpcy4kc2NvcGVkU2xvdHMuc2VsZWN0aW9uKHsKICAgICAgICBhdHRyczogewogICAgICAgICAgY2xhc3M6ICd2LWNoaXAtLXNlbGVjdCcKICAgICAgICB9LAogICAgICAgIHBhcmVudDogdGhpcywKICAgICAgICBpdGVtOiBpdGVtLAogICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICBzZWxlY3Q6IGZ1bmN0aW9uIHNlbGVjdChlKSB7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgX3RoaXMxMC5zZWxlY3RlZEluZGV4ID0gaW5kZXg7CiAgICAgICAgfSwKICAgICAgICBzZWxlY3RlZDogaW5kZXggPT09IHRoaXMuc2VsZWN0ZWRJbmRleCwKICAgICAgICBkaXNhYmxlZDogIXRoaXMuaXNJbnRlcmFjdGl2ZQogICAgICB9KTsKICAgIH0sCiAgICBnZXRNZW51SW5kZXg6IGZ1bmN0aW9uIGdldE1lbnVJbmRleCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHJlZnMubWVudSA/IHRoaXMuJHJlZnMubWVudS5saXN0SW5kZXggOiAtMTsKICAgIH0sCiAgICBnZXREaXNhYmxlZDogZnVuY3Rpb24gZ2V0RGlzYWJsZWQoaXRlbSkgewogICAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tSXRlbShpdGVtLCB0aGlzLml0ZW1EaXNhYmxlZCwgZmFsc2UpOwogICAgfSwKICAgIGdldFRleHQ6IGZ1bmN0aW9uIGdldFRleHQoaXRlbSkgewogICAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tSXRlbShpdGVtLCB0aGlzLml0ZW1UZXh0LCBpdGVtKTsKICAgIH0sCiAgICBnZXRWYWx1ZTogZnVuY3Rpb24gZ2V0VmFsdWUoaXRlbSkgewogICAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tSXRlbShpdGVtLCB0aGlzLml0ZW1WYWx1ZSwgdGhpcy5nZXRUZXh0KGl0ZW0pKTsKICAgIH0sCiAgICBvbkJsdXI6IGZ1bmN0aW9uIG9uQmx1cihlKSB7CiAgICAgIGUgJiYgdGhpcy4kZW1pdCgnYmx1cicsIGUpOwogICAgfSwKICAgIG9uQ2hpcElucHV0OiBmdW5jdGlvbiBvbkNoaXBJbnB1dChpdGVtKSB7CiAgICAgIGlmICh0aGlzLm11bHRpcGxlKSB0aGlzLnNlbGVjdEl0ZW0oaXRlbSk7ZWxzZSB0aGlzLnNldFZhbHVlKG51bGwpOyAvLyBJZiBhbGwgaXRlbXMgaGF2ZSBiZWVuIGRlbGV0ZWQsCiAgICAgIC8vIG9wZW4gYHYtbWVudWAKCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkSXRlbXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNNZW51QWN0aXZlID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xOwogICAgfSwKICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soZSkgewogICAgICBpZiAoIXRoaXMuaXNJbnRlcmFjdGl2ZSkgcmV0dXJuOwoKICAgICAgaWYgKCF0aGlzLmlzQXBwZW5kSW5uZXIoZS50YXJnZXQpKSB7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSB0cnVlOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7CiAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlOwogICAgICAgIHRoaXMuJGVtaXQoJ2ZvY3VzJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGVtaXQoJ2NsaWNrJywgZSk7CiAgICB9LAogICAgb25Fc2NEb3duOiBmdW5jdGlvbiBvbkVzY0Rvd24oZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICBpZiAodGhpcy5pc01lbnVBY3RpdmUpIHsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIHRoaXMuaXNNZW51QWN0aXZlID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBvbktleVByZXNzOiBmdW5jdGlvbiBvbktleVByZXNzKGUpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwoKICAgICAgaWYgKHRoaXMubXVsdGlwbGUgfHwgIXRoaXMuaXNJbnRlcmFjdGl2ZSB8fCB0aGlzLmRpc2FibGVMb29rdXApIHJldHVybjsKICAgICAgdmFyIEtFWUJPQVJEX0xPT0tVUF9USFJFU0hPTEQgPSAxMDAwOyAvLyBtaWxsaXNlY29uZHMKCiAgICAgIHZhciBub3cgPSBwZXJmb3JtYW5jZS5ub3coKTsKCiAgICAgIGlmIChub3cgLSB0aGlzLmtleWJvYXJkTG9va3VwTGFzdFRpbWUgPiBLRVlCT0FSRF9MT09LVVBfVEhSRVNIT0xEKSB7CiAgICAgICAgdGhpcy5rZXlib2FyZExvb2t1cFByZWZpeCA9ICcnOwogICAgICB9CgogICAgICB0aGlzLmtleWJvYXJkTG9va3VwUHJlZml4ICs9IGUua2V5LnRvTG93ZXJDYXNlKCk7CiAgICAgIHRoaXMua2V5Ym9hcmRMb29rdXBMYXN0VGltZSA9IG5vdzsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5hbGxJdGVtcy5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICB2YXIgdGV4dCA9IChfdGhpczExLmdldFRleHQoaXRlbSkgfHwgJycpLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIHRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKF90aGlzMTEua2V5Ym9hcmRMb29rdXBQcmVmaXgpOwogICAgICB9KTsKICAgICAgdmFyIGl0ZW0gPSB0aGlzLmFsbEl0ZW1zW2luZGV4XTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmxhc3RJdGVtID0gTWF0aC5tYXgodGhpcy5sYXN0SXRlbSwgaW5kZXggKyA1KTsKICAgICAgICB0aGlzLnNldFZhbHVlKHRoaXMucmV0dXJuT2JqZWN0ID8gaXRlbSA6IHRoaXMuZ2V0VmFsdWUoaXRlbSkpOwogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczExLiRyZWZzLm1lbnUuZ2V0VGlsZXMoKTsKICAgICAgICB9KTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpczExLnNldE1lbnVJbmRleChpbmRleCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBvbktleURvd246IGZ1bmN0aW9uIG9uS2V5RG93bihlKSB7CiAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmlzUmVhZG9ubHkgJiYgZS5rZXlDb2RlICE9PSBrZXlDb2Rlcy50YWIpIHJldHVybjsKICAgICAgdmFyIGtleUNvZGUgPSBlLmtleUNvZGU7CiAgICAgIHZhciBtZW51ID0gdGhpcy4kcmVmcy5tZW51OwogICAgICB0aGlzLiRlbWl0KCdrZXlkb3duJywgZSk7CiAgICAgIGlmICghbWVudSkgcmV0dXJuOyAvLyBJZiBtZW51IGlzIGFjdGl2ZSwgYWxsb3cgZGVmYXVsdAogICAgICAvLyBsaXN0SW5kZXggY2hhbmdlIGZyb20gbWVudQoKICAgICAgaWYgKHRoaXMuaXNNZW51QWN0aXZlICYmIFtrZXlDb2Rlcy51cCwga2V5Q29kZXMuZG93biwga2V5Q29kZXMuaG9tZSwga2V5Q29kZXMuZW5kLCBrZXlDb2Rlcy5lbnRlcl0uaW5jbHVkZXMoa2V5Q29kZSkpIHsKICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBtZW51LmNoYW5nZUxpc3RJbmRleChlKTsKCiAgICAgICAgICBfdGhpczEyLiRlbWl0KCd1cGRhdGU6bGlzdC1pbmRleCcsIG1lbnUubGlzdEluZGV4KTsKICAgICAgICB9KTsKICAgICAgfSAvLyBJZiBlbnRlciwgc3BhY2UsIG9wZW4gbWVudQoKCiAgICAgIGlmIChba2V5Q29kZXMuZW50ZXIsIGtleUNvZGVzLnNwYWNlXS5pbmNsdWRlcyhrZXlDb2RlKSkgdGhpcy5hY3RpdmF0ZU1lbnUoKTsgLy8gSWYgbWVudSBpcyBub3QgYWN0aXZlLCB1cC9kb3duL2hvbWUvZW5kIGNhbiBkbwogICAgICAvLyBvbmUgb2YgMiB0aGluZ3MuIElmIG11bHRpcGxlLCBvcGVucyB0aGUKICAgICAgLy8gbWVudSwgaWYgbm90LCB3aWxsIGN5Y2xlIHRocm91Z2ggYWxsCiAgICAgIC8vIGF2YWlsYWJsZSBvcHRpb25zCgogICAgICBpZiAoIXRoaXMuaXNNZW51QWN0aXZlICYmIFtrZXlDb2Rlcy51cCwga2V5Q29kZXMuZG93biwga2V5Q29kZXMuaG9tZSwga2V5Q29kZXMuZW5kXS5pbmNsdWRlcyhrZXlDb2RlKSkgcmV0dXJuIHRoaXMub25VcERvd24oZSk7IC8vIElmIGVzY2FwZSBkZWFjdGl2YXRlIHRoZSBtZW51CgogICAgICBpZiAoa2V5Q29kZSA9PT0ga2V5Q29kZXMuZXNjKSByZXR1cm4gdGhpcy5vbkVzY0Rvd24oZSk7IC8vIElmIHRhYiAtIHNlbGVjdCBpdGVtIG9yIGNsb3NlIG1lbnUKCiAgICAgIGlmIChrZXlDb2RlID09PSBrZXlDb2Rlcy50YWIpIHJldHVybiB0aGlzLm9uVGFiRG93bihlKTsgLy8gSWYgc3BhY2UgcHJldmVudERlZmF1bHQKCiAgICAgIGlmIChrZXlDb2RlID09PSBrZXlDb2Rlcy5zcGFjZSkgcmV0dXJuIHRoaXMub25TcGFjZURvd24oZSk7CiAgICB9LAogICAgb25NZW51QWN0aXZlQ2hhbmdlOiBmdW5jdGlvbiBvbk1lbnVBY3RpdmVDaGFuZ2UodmFsKSB7CiAgICAgIC8vIElmIG1lbnUgaXMgY2xvc2luZyBhbmQgbXVsaXRwbGUKICAgICAgLy8gb3IgbWVudUluZGV4IGlzIGFscmVhZHkgc2V0CiAgICAgIC8vIHNraXAgbWVudSBpbmRleCByZWNhbGN1bGF0aW9uCiAgICAgIGlmICh0aGlzLm11bHRpcGxlICYmICF2YWwgfHwgdGhpcy5nZXRNZW51SW5kZXgoKSA+IC0xKSByZXR1cm47CiAgICAgIHZhciBtZW51ID0gdGhpcy4kcmVmcy5tZW51OwogICAgICBpZiAoIW1lbnUgfHwgIXRoaXMuaXNEaXJ0eSkgcmV0dXJuOyAvLyBXaGVuIG1lbnUgb3BlbnMsIHNldCBpbmRleCBvZiBmaXJzdCBhY3RpdmUgaXRlbQoKICAgICAgdGhpcy4kcmVmcy5tZW51LmdldFRpbGVzKCk7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1lbnUudGlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAobWVudS50aWxlc1tpXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKSA9PT0gJ3RydWUnKSB7CiAgICAgICAgICB0aGlzLnNldE1lbnVJbmRleChpKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIG9uTW91c2VVcDogZnVuY3Rpb24gb25Nb3VzZVVwKGUpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHNvbmFyanMvbm8tY29sbGFwc2libGUtaWYKICAgICAgaWYgKHRoaXMuaGFzTW91c2VEb3duICYmIGUud2hpY2ggIT09IDMgJiYgdGhpcy5pc0ludGVyYWN0aXZlKSB7CiAgICAgICAgLy8gSWYgYXBwZW5kIGlubmVyIGlzIHByZXNlbnQKICAgICAgICAvLyBhbmQgdGhlIHRhcmdldCBpcyBpdHNlbGYKICAgICAgICAvLyBvciBpbnNpZGUsIHRvZ2dsZSBtZW51CiAgICAgICAgaWYgKHRoaXMuaXNBcHBlbmRJbm5lcihlLnRhcmdldCkpIHsKICAgICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMTMuaXNNZW51QWN0aXZlID0gIV90aGlzMTMuaXNNZW51QWN0aXZlOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBWVGV4dEZpZWxkLm9wdGlvbnMubWV0aG9kcy5vbk1vdXNlVXAuY2FsbCh0aGlzLCBlKTsKICAgIH0sCiAgICBvblNjcm9sbDogZnVuY3Rpb24gb25TY3JvbGwoKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5pc01lbnVBY3RpdmUpIHsKICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMTQuZ2V0Q29udGVudCgpLnNjcm9sbFRvcCA9IDA7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMubGFzdEl0ZW0gPiB0aGlzLmNvbXB1dGVkSXRlbXMubGVuZ3RoKSByZXR1cm47CiAgICAgICAgdmFyIHNob3dNb3JlSXRlbXMgPSB0aGlzLmdldENvbnRlbnQoKS5zY3JvbGxIZWlnaHQgLSAodGhpcy5nZXRDb250ZW50KCkuc2Nyb2xsVG9wICsgdGhpcy5nZXRDb250ZW50KCkuY2xpZW50SGVpZ2h0KSA8IDIwMDsKCiAgICAgICAgaWYgKHNob3dNb3JlSXRlbXMpIHsKICAgICAgICAgIHRoaXMubGFzdEl0ZW0gKz0gMjA7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb25TcGFjZURvd246IGZ1bmN0aW9uIG9uU3BhY2VEb3duKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfSwKICAgIG9uVGFiRG93bjogZnVuY3Rpb24gb25UYWJEb3duKGUpIHsKICAgICAgdmFyIG1lbnUgPSB0aGlzLiRyZWZzLm1lbnU7CiAgICAgIGlmICghbWVudSkgcmV0dXJuOwogICAgICB2YXIgYWN0aXZlVGlsZSA9IG1lbnUuYWN0aXZlVGlsZTsgLy8gQW4gaXRlbSB0aGF0IGlzIHNlbGVjdGVkIGJ5CiAgICAgIC8vIG1lbnUtaW5kZXggc2hvdWxkIHRvZ2dsZWQKCiAgICAgIGlmICghdGhpcy5tdWx0aXBsZSAmJiBhY3RpdmVUaWxlICYmIHRoaXMuaXNNZW51QWN0aXZlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgYWN0aXZlVGlsZS5jbGljaygpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIElmIHdlIG1ha2UgaXQgaGVyZSwKICAgICAgICAvLyB0aGUgdXNlciBoYXMgbm8gc2VsZWN0ZWQgaW5kZXhlcwogICAgICAgIC8vIGFuZCBpcyBwcm9iYWJseSB0YWJiaW5nIG91dAogICAgICAgIHRoaXMuYmx1cihlKTsKICAgICAgfQogICAgfSwKICAgIG9uVXBEb3duOiBmdW5jdGlvbiBvblVwRG93bihlKSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKCiAgICAgIHZhciBtZW51ID0gdGhpcy4kcmVmcy5tZW51OwogICAgICBpZiAoIW1lbnUpIHJldHVybjsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBNdWx0aXBsZSBzZWxlY3RzIGRvIG5vdCBjeWNsZSB0aGVpciB2YWx1ZQogICAgICAvLyB3aGVuIHByZXNzaW5nIHVwIG9yIGRvd24sIGluc3RlYWQgYWN0aXZhdGUKICAgICAgLy8gdGhlIG1lbnUKCiAgICAgIGlmICh0aGlzLm11bHRpcGxlKSByZXR1cm4gdGhpcy5hY3RpdmF0ZU1lbnUoKTsKICAgICAgdmFyIGtleUNvZGUgPSBlLmtleUNvZGU7IC8vIEN5Y2xlIHRocm91Z2ggYXZhaWxhYmxlIHZhbHVlcyB0byBhY2hpZXZlCiAgICAgIC8vIHNlbGVjdCBuYXRpdmUgYmVoYXZpb3IKCiAgICAgIG1lbnUuaXNCb290ZWQgPSB0cnVlOwogICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHsKICAgICAgICBtZW51LmdldFRpbGVzKCk7CiAgICAgICAgaWYgKCFtZW51Lmhhc0NsaWNrYWJsZVRpbGVzKSByZXR1cm4gX3RoaXMxNS5hY3RpdmF0ZU1lbnUoKTsKCiAgICAgICAgc3dpdGNoIChrZXlDb2RlKSB7CiAgICAgICAgICBjYXNlIGtleUNvZGVzLnVwOgogICAgICAgICAgICBtZW51LnByZXZUaWxlKCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2Uga2V5Q29kZXMuZG93bjoKICAgICAgICAgICAgbWVudS5uZXh0VGlsZSgpOwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIGtleUNvZGVzLmhvbWU6CiAgICAgICAgICAgIG1lbnUuZmlyc3RUaWxlKCk7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2Uga2V5Q29kZXMuZW5kOgogICAgICAgICAgICBtZW51Lmxhc3RUaWxlKCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMxNS5zZWxlY3RJdGVtKF90aGlzMTUuYWxsSXRlbXNbX3RoaXMxNS5nZXRNZW51SW5kZXgoKV0pOwogICAgICB9KTsKICAgIH0sCiAgICBzZWxlY3RJdGVtOiBmdW5jdGlvbiBzZWxlY3RJdGVtKGl0ZW0pIHsKICAgICAgdmFyIF90aGlzMTYgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLm11bHRpcGxlKSB7CiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLnJldHVybk9iamVjdCA/IGl0ZW0gOiB0aGlzLmdldFZhbHVlKGl0ZW0pKTsKICAgICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBpbnRlcm5hbFZhbHVlID0gKHRoaXMuaW50ZXJuYWxWYWx1ZSB8fCBbXSkuc2xpY2UoKTsKICAgICAgICB2YXIgaSA9IHRoaXMuZmluZEV4aXN0aW5nSW5kZXgoaXRlbSk7CiAgICAgICAgaSAhPT0gLTEgPyBpbnRlcm5hbFZhbHVlLnNwbGljZShpLCAxKSA6IGludGVybmFsVmFsdWUucHVzaChpdGVtKTsKICAgICAgICB0aGlzLnNldFZhbHVlKGludGVybmFsVmFsdWUubWFwKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMxNi5yZXR1cm5PYmplY3QgPyBpIDogX3RoaXMxNi5nZXRWYWx1ZShpKTsKICAgICAgICB9KSk7IC8vIFRoZXJlIGlzIG5vIGl0ZW0gdG8gcmUtaGlnaGxpZ2h0CiAgICAgICAgLy8gd2hlbiBzZWxlY3Rpb25zIGFyZSBoaWRkZW4KCiAgICAgICAgaWYgKHRoaXMuaGlkZVNlbGVjdGVkKSB7CiAgICAgICAgICB0aGlzLnNldE1lbnVJbmRleCgtMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuYWxsSXRlbXMuaW5kZXhPZihpdGVtKTsKCiAgICAgICAgICBpZiAofmluZGV4KSB7CiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNi4kcmVmcy5tZW51LmdldFRpbGVzKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMxNi5zZXRNZW51SW5kZXgoaW5kZXgpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBzZXRNZW51SW5kZXg6IGZ1bmN0aW9uIHNldE1lbnVJbmRleChpbmRleCkgewogICAgICB0aGlzLiRyZWZzLm1lbnUgJiYgKHRoaXMuJHJlZnMubWVudS5saXN0SW5kZXggPSBpbmRleCk7CiAgICB9LAogICAgc2V0U2VsZWN0ZWRJdGVtczogZnVuY3Rpb24gc2V0U2VsZWN0ZWRJdGVtcygpIHsKICAgICAgdmFyIF90aGlzMTcgPSB0aGlzOwoKICAgICAgdmFyIHNlbGVjdGVkSXRlbXMgPSBbXTsKICAgICAgdmFyIHZhbHVlcyA9ICF0aGlzLm11bHRpcGxlIHx8ICFBcnJheS5pc0FycmF5KHRoaXMuaW50ZXJuYWxWYWx1ZSkgPyBbdGhpcy5pbnRlcm5hbFZhbHVlXSA6IHRoaXMuaW50ZXJuYWxWYWx1ZTsKCiAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih2YWx1ZXMpLAogICAgICAgICAgX3N0ZXA7CgogICAgICB0cnkgewogICAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKCkgewogICAgICAgICAgdmFyIHZhbHVlID0gX3N0ZXAudmFsdWU7CgogICAgICAgICAgdmFyIGluZGV4ID0gX3RoaXMxNy5hbGxJdGVtcy5maW5kSW5kZXgoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMTcudmFsdWVDb21wYXJhdG9yKF90aGlzMTcuZ2V0VmFsdWUodiksIF90aGlzMTcuZ2V0VmFsdWUodmFsdWUpKTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgICAgICAgIHNlbGVjdGVkSXRlbXMucHVzaChfdGhpczE3LmFsbEl0ZW1zW2luZGV4XSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgIF9sb29wKCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgIH0KCiAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtcyA9IHNlbGVjdGVkSXRlbXM7CiAgICB9LAogICAgc2V0VmFsdWU6IGZ1bmN0aW9uIHNldFZhbHVlKHZhbHVlKSB7CiAgICAgIGlmICghdGhpcy52YWx1ZUNvbXBhcmF0b3IodmFsdWUsIHRoaXMuaW50ZXJuYWxWYWx1ZSkpIHsKICAgICAgICB0aGlzLmludGVybmFsVmFsdWUgPSB2YWx1ZTsKICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCB2YWx1ZSk7CiAgICAgIH0KICAgIH0sCiAgICBpc0FwcGVuZElubmVyOiBmdW5jdGlvbiBpc0FwcGVuZElubmVyKHRhcmdldCkgewogICAgICAvLyByZXR1cm4gdHJ1ZSBpZiBhcHBlbmQgaW5uZXIgaXMgcHJlc2VudAogICAgICAvLyBhbmQgdGhlIHRhcmdldCBpcyBpdHNlbGYgb3IgaW5zaWRlCiAgICAgIHZhciBhcHBlbmRJbm5lciA9IHRoaXMuJHJlZnNbJ2FwcGVuZC1pbm5lciddOwogICAgICByZXR1cm4gYXBwZW5kSW5uZXIgJiYgKGFwcGVuZElubmVyID09PSB0YXJnZXQgfHwgYXBwZW5kSW5uZXIuY29udGFpbnModGFyZ2V0KSk7CiAgICB9CiAgfQp9KTs="},null]}