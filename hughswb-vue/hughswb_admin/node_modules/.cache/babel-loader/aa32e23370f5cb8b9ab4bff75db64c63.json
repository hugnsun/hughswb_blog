{"remainingRequest":"/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/babel-loader/lib/index.js!/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/src/views/about/About.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/src/views/about/About.vue","mtime":1666926022000},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/cache-loader/dist/cjs.js","mtime":1671701058468},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/babel-loader/lib/index.js","mtime":1671701058672},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/cache-loader/dist/cjs.js","mtime":1671701058468},{"path":"/Users/sunwenbo/Downloads/博客/new-blog-master/hughswb_blog/hughswb-vue/hughswb_admin/node_modules/vue-loader/lib/index.js","mtime":1671701059661}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCAqIGFzIGltYWdlQ29udmVyc2lvbiBmcm9tICJpbWFnZS1jb252ZXJzaW9uIjsKZXhwb3J0IGRlZmF1bHQgewogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldEFib3V0KCk7CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWJvdXRDb250ZW50OiAiIgogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldEFib3V0OiBmdW5jdGlvbiBnZXRBYm91dCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMuYXhpb3MuZ2V0KCIvYXBpL2Fib3V0IikudGhlbihmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciBkYXRhID0gX3JlZi5kYXRhOwogICAgICAgIF90aGlzLmFib3V0Q29udGVudCA9IGRhdGEuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgdXBsb2FkSW1nOiBmdW5jdGlvbiB1cGxvYWRJbWcocG9zLCBmaWxlKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGZvcm1kYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICBpZiAoZmlsZS5zaXplIC8gMTAyNCA8IHRoaXMuY29uZmlnLlVQTE9BRF9TSVpFKSB7CiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKCJmaWxlIiwgZmlsZSk7CiAgICAgICAgdGhpcy5heGlvcy5wb3N0KCIvYXBpL2FkbWluL2FydGljbGVzL2ltYWdlcyIsIGZvcm1kYXRhKS50aGVuKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgICAgdmFyIGRhdGEgPSBfcmVmMi5kYXRhOwoKICAgICAgICAgIF90aGlzMi4kcmVmcy5tZC4kaW1nMlVybChwb3MsIGRhdGEuZGF0YSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5Y6L57yp5YiwMjAwS0Is6L+Z6YeM55qEMjAw5bCx5piv6KaB5Y6L57yp55qE5aSn5bCPLOWPr+iHquWumuS5iQogICAgICAgIGltYWdlQ29udmVyc2lvbi5jb21wcmVzc0FjY3VyYXRlbHkoZmlsZSwgdGhpcy5jb25maWcuVVBMT0FEX1NJWkUpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgZm9ybWRhdGEuYXBwZW5kKCJmaWxlIiwgbmV3IHdpbmRvdy5GaWxlKFtyZXNdLCBmaWxlLm5hbWUsIHsKICAgICAgICAgICAgdHlwZTogZmlsZS50eXBlCiAgICAgICAgICB9KSk7CgogICAgICAgICAgX3RoaXMyLmF4aW9zLnBvc3QoIi9hcGkvYWRtaW4vYXJ0aWNsZXMvaW1hZ2VzIiwgZm9ybWRhdGEpLnRoZW4oZnVuY3Rpb24gKF9yZWYzKSB7CiAgICAgICAgICAgIHZhciBkYXRhID0gX3JlZjMuZGF0YTsKCiAgICAgICAgICAgIF90aGlzMi4kcmVmcy5tZC4kaW1nMlVybChwb3MsIGRhdGEuZGF0YSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHVwZGF0ZUFib3V0OiBmdW5jdGlvbiB1cGRhdGVBYm91dCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLmF4aW9zLnB1dCgiL2FwaS9hZG1pbi9hYm91dCIsIHsKICAgICAgICBhYm91dENvbnRlbnQ6IHRoaXMuYWJvdXRDb250ZW50CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKF9yZWY0KSB7CiAgICAgICAgdmFyIGRhdGEgPSBfcmVmNC5kYXRhOwoKICAgICAgICBpZiAoZGF0YS5mbGFnKSB7CiAgICAgICAgICBfdGhpczMuJG5vdGlmeS5zdWNjZXNzKHsKICAgICAgICAgICAgdGl0bGU6ICLmiJDlip8iLAogICAgICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpczMuJG5vdGlmeS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAi5aSx6LSlIiwKICAgICAgICAgICAgbWVzc2FnZTogZGF0YS5tZXNzYWdlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["About.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA,OAAA,KAAA,eAAA,MAAA,kBAAA;AACA,eAAA;AACA,EAAA,OADA,qBACA;AACA,SAAA,QAAA;AACA,GAHA;AAIA,EAAA,IAAA,EAAA,gBAAA;AACA,WAAA;AACA,MAAA,YAAA,EAAA;AADA,KAAA;AAGA,GARA;AASA,EAAA,OAAA,EAAA;AACA,IAAA,QADA,sBACA;AAAA;;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,YAAA,EAAA,IAAA,CAAA,gBAAA;AAAA,YAAA,IAAA,QAAA,IAAA;AACA,QAAA,KAAA,CAAA,YAAA,GAAA,IAAA,CAAA,IAAA;AACA,OAFA;AAGA,KALA;AAMA,IAAA,SANA,qBAMA,GANA,EAMA,IANA,EAMA;AAAA;;AACA,UAAA,QAAA,GAAA,IAAA,QAAA,EAAA;;AACA,UAAA,IAAA,CAAA,IAAA,GAAA,IAAA,GAAA,KAAA,MAAA,CAAA,WAAA,EAAA;AACA,QAAA,QAAA,CAAA,MAAA,CAAA,MAAA,EAAA,IAAA;AACA,aAAA,KAAA,CACA,IADA,CACA,4BADA,EACA,QADA,EAEA,IAFA,CAEA,iBAAA;AAAA,cAAA,IAAA,SAAA,IAAA;;AACA,UAAA,MAAA,CAAA,KAAA,CAAA,EAAA,CAAA,QAAA,CAAA,GAAA,EAAA,IAAA,CAAA,IAAA;AACA,SAJA;AAKA,OAPA,MAOA;AACA;AACA,QAAA,eAAA,CACA,kBADA,CACA,IADA,EACA,KAAA,MAAA,CAAA,WADA,EAEA,IAFA,CAEA,UAAA,GAAA,EAAA;AACA,UAAA,QAAA,CAAA,MAAA,CACA,MADA,EAEA,IAAA,MAAA,CAAA,IAAA,CAAA,CAAA,GAAA,CAAA,EAAA,IAAA,CAAA,IAAA,EAAA;AAAA,YAAA,IAAA,EAAA,IAAA,CAAA;AAAA,WAAA,CAFA;;AAIA,UAAA,MAAA,CAAA,KAAA,CACA,IADA,CACA,4BADA,EACA,QADA,EAEA,IAFA,CAEA,iBAAA;AAAA,gBAAA,IAAA,SAAA,IAAA;;AACA,YAAA,MAAA,CAAA,KAAA,CAAA,EAAA,CAAA,QAAA,CAAA,GAAA,EAAA,IAAA,CAAA,IAAA;AACA,WAJA;AAKA,SAZA;AAaA;AACA,KA/BA;AAgCA,IAAA,WAhCA,yBAgCA;AAAA;;AACA,WAAA,KAAA,CACA,GADA,CACA,kBADA,EACA;AACA,QAAA,YAAA,EAAA,KAAA;AADA,OADA,EAIA,IAJA,CAIA,iBAAA;AAAA,YAAA,IAAA,SAAA,IAAA;;AACA,YAAA,IAAA,CAAA,IAAA,EAAA;AACA,UAAA,MAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AACA,YAAA,KAAA,EAAA,IADA;AAEA,YAAA,OAAA,EAAA,IAAA,CAAA;AAFA,WAAA;AAIA,SALA,MAKA;AACA,UAAA,MAAA,CAAA,OAAA,CAAA,KAAA,CAAA;AACA,YAAA,KAAA,EAAA,IADA;AAEA,YAAA,OAAA,EAAA,IAAA,CAAA;AAFA,WAAA;AAIA;AACA,OAhBA;AAiBA;AAlDA;AATA,CAAA","sourcesContent":["<template>\n  <el-card class=\"main-card\">\n    <div class=\"title\">{{ this.$route.name }}</div>\n    <mavon-editor\n      ref=\"md\"\n      @imgAdd=\"uploadImg\"\n      v-model=\"aboutContent\"\n      style=\"height:calc(100vh - 250px);margin-top:2.25rem\"\n    />\n    <el-button\n      type=\"danger\"\n      size=\"medium\"\n      class=\"edit-btn\"\n      @click=\"updateAbout\"\n    >\n      修改\n    </el-button>\n  </el-card>\n</template>\n\n<script>\nimport * as imageConversion from \"image-conversion\";\nexport default {\n  created() {\n    this.getAbout();\n  },\n  data: function() {\n    return {\n      aboutContent: \"\"\n    };\n  },\n  methods: {\n    getAbout() {\n      this.axios.get(\"/api/about\").then(({ data }) => {\n        this.aboutContent = data.data;\n      });\n    },\n    uploadImg(pos, file) {\n      var formdata = new FormData();\n      if (file.size / 1024 < this.config.UPLOAD_SIZE) {\n        formdata.append(\"file\", file);\n        this.axios\n          .post(\"/api/admin/articles/images\", formdata)\n          .then(({ data }) => {\n            this.$refs.md.$img2Url(pos, data.data);\n          });\n      } else {\n        // 压缩到200KB,这里的200就是要压缩的大小,可自定义\n        imageConversion\n          .compressAccurately(file, this.config.UPLOAD_SIZE)\n          .then(res => {\n            formdata.append(\n              \"file\",\n              new window.File([res], file.name, { type: file.type })\n            );\n            this.axios\n              .post(\"/api/admin/articles/images\", formdata)\n              .then(({ data }) => {\n                this.$refs.md.$img2Url(pos, data.data);\n              });\n          });\n      }\n    },\n    updateAbout() {\n      this.axios\n        .put(\"/api/admin/about\", {\n          aboutContent: this.aboutContent\n        })\n        .then(({ data }) => {\n          if (data.flag) {\n            this.$notify.success({\n              title: \"成功\",\n              message: data.message\n            });\n          } else {\n            this.$notify.error({\n              title: \"失败\",\n              message: data.message\n            });\n          }\n        });\n    }\n  }\n};\n</script>\n\n<style scoped>\n.edit-btn {\n  float: right;\n  margin: 1rem 0;\n}\n</style>\n"],"sourceRoot":"src/views/about"}]}